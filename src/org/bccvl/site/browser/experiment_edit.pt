<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="plone"
      metal:use-macro="context/main_template/macros/master">

    <metal:block fill-slot="main">

        <h1 class="documentFirstHeading" tal:content="view/label | nothing" />

        <div id="content-core">
            <metal:block
                use-macro="context/@@ploneform-macros/titlelessform" >
          <metal:block fill-slot="fields">
             <metal:fields
                 use-macro="context/@@ploneform-macros/fields"/>
               <!-- Algorithm parameter fieldsets -->
               <fieldset id="algo_params">
                 <legend id="algo_params_label">Algo Params</legend>
               <tal:block tal:repeat="group view/param_groups"
                          condition="view/param_groups">
                 <fieldset
                     tal:define="normalizeString nocall:context/@@plone/normalizeString;
                                 fieldset_label group/label;
                                 fieldset_name group/__name__|group/label/default|fieldset_label;
                                 fieldset_name python:normalizeString(fieldset_name);"
                     tal:attributes="id string:fieldset-${fieldset_name};
                                     class string:kssattr-fieldset-${fieldset_name};
                                     data-fieldset fieldset_name">

                     <legend tal:condition="fieldset_label"
                             tal:attributes="id string:fieldsetlegend-${fieldset_name}"
                             tal:content="fieldset_label">Form name</legend>

                     <p i18n:translate=""
                        tal:define="group_description group/description|nothing"
                        tal:condition="group_description"
                        tal:content="structure group_description">
                        Description
                     </p>

                     <tal:block tal:define="errors group/widgets/errors"
                                tal:condition="errors"
                                tal:repeat="error errors">
                       <div class="field error"
                            tal:condition="not:nocall:error/widget"
                            tal:content="structure error/render"
                            />
                     </tal:block>

                     <tal:block define="view nocall:group">
                       <metal:block use-macro="context/@@ploneform-macros/widget_rendering" />
                     </tal:block>
                 </fieldset>
               </tal:block>
               </fieldset>
          </metal:block>
        </metal:block>

        </div>

    </metal:block>

</html>
