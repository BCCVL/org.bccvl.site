<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">

<body>

<metal:content-body fill-slot="body">
  <!-- other view/request parameters:
       limit_display ... batch_size
       more_url
       folderContents ... either passed in or queried from catalog
       b_start
  -->
  <div id="content">

    <tal:tabs metal:use-macro="context/datasets-macros/datasets_tabs"></tal:tabs>

    <!-- search filters -->
    <form action="" method="get" id="datasets-filter-form">
      <div id="bccvl-datasetlist-filter" class="row">
        <div class="cell position-0 width-5">
          <p>Search</p>
          <div class="input-append">
            <input id="datasets-filter-text"
                   name="datasets.filter.text" type="text"
                   placeholder="Search Datesets" class="input-medium"
                   tal:attributes="value python:request.get('datasets.filter.text')"/>
            <button class="btn" type="submit">Go!</button>
          </div>
          <button type="submit" name="datasets.filter.submit" id="datasets-filter-submit">Submit Filter</button>
          <button type="reset">Reset Filter</button>
        </div>
        <div class="cell position-5">
          <p>Filter</p>
          <select id="datasets-filter-genre"
                  name="datasets.filter.genre:list" multiple="multiple">
            <option disabled="disabled">Select a Genre</option>
            <option value="optionvalue"
                    tal:repeat="opt view/genre_list"
                    tal:attributes="selected opt/selected;
                                    disabled opt/disabled;
                                    value opt/token;"
                    tal:content="opt/label">Option label</option>
          </select>
          <select id="datasets-filter-resolution"
                  name="datasets.filter.resolution:list"
                  multiple="multiple"
                  value="">
            <option disabled="disabled">Select a Resolution</option>
            <option value="optionvalue"
                    tal:repeat="opt view/resolution_list"
                    tal:attributes="selected opt/selected;
                                    disabled opt/disabled;
                                    value opt/token;"
                    tal:content="opt/label">Option label</option>
          </select>
          <select id="datasets-filter-source"
                  name="datasets.filter.source:list"
                  multiple="multiple">
            <option disabled="disabled">Select a Source</option>
            <option value="optionvalue"
                    tal:repeat="opt view/source_list"
                    tal:attributes="selected opt/selected;
                                    disabled opt/disabled;
                                    value opt/token;"
                    tal:content="opt/label">Option label</option>
          </select>
        </div>
      </div>
    </form>

    <div class="row" id="datasets-listing" metal:define-macro="datasets_list"
         tal:define="batch view/datasetslisting;
                     plone_view context/@@plone;
                     pas_member context/@@pas_member;
                     navigation_root_url context/@@plone_portal_state/navigation_root_url;
                     normalizeString nocall: context/plone_utils/normalizeString;
                     toLocalizedTime nocall: context/@@plone/toLocalizedTime;
                     site_properties context/portal_properties/site_properties;
                     isAnon context/@@plone_portal_state/anonymous;
                     show_about python:not isAnon or site_properties.allowAnonymousViewAbout;">
      <div class="alert" tal:condition="not: batch">
        <p>No matches found</p>
      </div>

      <tal:condition tal:condition="batch">
      <div metal:use-macro="context/batch_macros/macros/navigation" />

      <table class="listing"
             summary="Content listing"
             i18n:attributes="summary summary_content_listing;">
        <thead>
          <tr>
            <th class="nosort"><tal:title i18n:translate="listingheader_title">Title</tal:title></th>
            <th class="nosort"
                tal:condition="show_about"
                ><tal:title i18n:translate="listingheader_author">Author</tal:title></th>
            <th class="nosort"><tal:title i18n:translate="listingheader_type">Genre</tal:title></th>
            <th class="nosort"
                tal:condition="show_about"
                ><tal:modified i18n:translate="listingheader_modified">Modified</tal:modified></th>
            <th class="nosort"
                tal:condition="show_about"
                ><tal:title i18n:translate="State">State</tal:title></th>
            <th class="nosort"
                tal:condition="show_about"
                ><tal:title i18n:translate="Actions">Actions</tal:title></th>
            <th class="nosort"><tal:title i18n:translate="Download">Download</tal:title></th>
          </tr>
        </thead>
        <tbody>
          <tal:repeat tal:repeat="item batch">
            <tal:define tal:define="rowstyle python: repeat['item'].odd and 'even' or 'odd';
                                    item_title_or_id item/pretty_title_or_id;
                                    item_icon python:plone_view.getIcon(item);
                                    item_creator item/Creator;
                                    item_modified item/ModificationDate;
                                    item_url item/getURL|item/absolute_url;
                                    item_description item/Description;
                                    item_type item/portal_type;
                                    item_type_class python:'contenttype-' + normalizeString(item_type);
                                    item_genre item/BCCDataGenre;
                                    item_genre_title python:view.item_genre_title(item['BCCDataGenre']);
                                    item_wf_state item/review_state|python: context.portal_workflow.getInfoFor(item, 'review_state', '');
                                    item_wf_state_class python:'state-' + normalizeString(item_wf_state);
                                    use_view_action site_properties/typesUseViewActionInListings|python:();
                                    item_obj item/getObject
                                    ">
              <metal:block
                  use-macro="context/datasets-macros/datasets_listitem"></metal:block>
            </tal:define>
          </tal:repeat>
        </tbody>
      </table>

      <div metal:use-macro="context/batch_macros/macros/navigation" />

      <!--                                  item_obj item/getObject;"> -->

      </tal:condition>
    </div>
    </div>
</metal:content-body>

</body>
</html>
