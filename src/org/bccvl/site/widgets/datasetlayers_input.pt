<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      tal:omit-tag="">
  <script type="text/javascript"
          tal:content="structure view/js"></script>
  <a id="fieldname-popup" href="#"
     tal:attributes="id string:${view/field/__name__}-popup"
     tal:content="string:Select ${view/label}">Select Occurrence Dataset</a>
  <div id="form-widgets-fieldname-selected"
       tal:attributes="id string:${view/id}-selected">
    <tal:repeat tal:repeat="item view/items">
      <div class="selecteditem"
           tal:define="layer item/layer;
                       brain item/brain;
                       index repeat/item/index;">
        <input type="hidden" value="" name="form.widgets.fieldname.dataset.0"
               tal:attributes="value brain/UID;
                               name string:${view/name}.dataset.${index};
                               "/>
        <input type="hidden" value="" name="form.widgets.fieldname.layer.0"
               tal:attributes="value layer/layer;
                               name string:${view/name}.layer.${index};
                               "/>
        <a class="btn btn-mini" href="#"><i class="icon-remove"></i></a>
        <span tal:content="brain/Title">Dataset</span>
        <span tal:content="layer/label">Layer</span>
        <!-- TODO: should this one be outside of the div here?
                   need to update load script to fetch it as well
                   though -->
        <input type="hidden" value="" name="form.widgets.name.count"
               tal:condition="repeat/item/end"
               tal:attributes="value repeat/item/number;
                               name string:${view/name}.count"/>
      </div>
    </tal:repeat>
  </div>
</html>
